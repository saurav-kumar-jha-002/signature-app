<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            height: 100vh;
            width: 100vw;
            background-color: rgba(43, 38, 38, 0.822);
        }
        button {
            cursor: pointer;
            height: 30px;
            width: 100px;
            outline: none;
            border: 2px solid transparent;
            border-radius: 10px;
            font-size: 18px;
        }

        button:active {
            background-color: rgb(45, 116, 89);
        }
    </style>
</head>

<body>
    <canvas id="canvas-id" height="200" width="300" style="border: 1px solid black;"></canvas>
    <button id="clr-btn">CLEAR</button>
    <button id="save-btn">SAVE</button>
    <script>
        const canvas = document.getElementById("canvas-id")
        const cnx = canvas.getContext("2d")
        const clr = document.getElementById("clr-btn")
        const save = document.getElementById("save-btn")

        let isDrawing = false;
        let lastx = 0
        let lasty = 0;
        canvas.addEventListener("mousedown", (e) => {
            isDrawing = true;
            [lastx, lasty] = [e.offsetX, e.offsetY]
            console.log(e);
            
        })

        canvas.addEventListener("mousemove", (e) => {
            if (!isDrawing) return;

            cnx.beginPath()
            cnx.moveTo(lastx, lasty)
            cnx.lineTo(e.clientX, e.clientY)
            cnx.strokeStyle = "red"
            cnx.backgroundColor="white"
            cnx.lineWidth = 2;
            cnx.lineCap = "round"
            cnx.stroke()

            [lastx, lasty] = [e.offsetX, e.offsetY]
            console.log(e);
        })

        canvas.addEventListener("mouseup", (e) => {
            isDrawing = false;
            console.log(e);
        })
        canvas.addEventListener("mouseout", (e) => { isDrawing = false;  console.log(e); })
        clr.addEventListener("click", () => {
            cnx.clearRect(0, 0, canvas.width, canvas.height)
        })
        save.addEventListener("click", () => {
            let image = canvas.toDataURL("png", 1.0)
            downloadImage(image, "my-canvas")
        })
        function downloadImage(data, filename = 'untitled.png') {
            var a = document.createElement('a');
            a.href = data;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
        }

    </script>
</body>

</html>